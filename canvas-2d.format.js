var k="http://www.w3.org/2000/svg";var B=e=>{let t=document.createElementNS(k,"path");return t.setAttributeNS(null,"d",e),Math.ceil(t.getTotalLength())};var D=e=>{let t=document.createElementNS(k,"svg");t.setAttributeNS(null,"transform",e);let n=t.transform.baseVal.consolidate();if(n===null)throw new Error("Cannot get svg transform.");return n.matrix};var L=e=>{let[t,n,r,o]=e.split(" ").map(s=>parseInt(s,10));return{minX:t,minY:n,width:r,height:o}};var X="canvas-2d",E=e=>{let{a:t,b:n,c:r,d:o,e:s,f:l}=D(e);return d=>{d.transform(t,n,r,o,s,l)}},R=(e,t)=>{e.save(),e.lineWidth=t.width,e.strokeStyle=t.color,e.beginPath(),e.moveTo(t.line.startPoint.x,t.line.startPoint.y),e.lineTo(t.line.endPoint.x,t.line.endPoint.y),e.stroke(),e.restore()},O=(e,t)=>{if(!t.includeGrid)return;let{width:n,height:r}=e.canvas;for(let o=1;o<t.gridColumns;o+=1){let s=n*(o/t.gridColumns);R(e,{line:{startPoint:{x:s,y:0},endPoint:{x:s,y:r}},width:Math.ceil(n/100),color:t.gridColor})}for(let o=1;o<t.gridRows;o+=1){let s=r*(o/t.gridRows);R(e,{line:{startPoint:{x:0,y:s},endPoint:{x:n,y:s}},width:Math.ceil(r/100),color:t.gridColor})}},N=(e,t)=>{let{includeBackground:n,backgroundColor:r}=t;e.save(),n?(e.fillStyle=r,e.fillRect(0,0,e.canvas.width,e.canvas.height)):e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore(),O(e,t)},P=(e,t,n)=>{e.save();let{clipPath:r,strokePath:o,strokeWidth:s,strokePathLength:l,parsedViewBox:d,strokeColor:h,contextTransform:w}=t;e.scale(e.canvas.width/d.width,e.canvas.height/d.height),w!==null&&w(e),e.fillStyle="none",e.strokeStyle=h,e.lineCap="round",e.lineJoin="round",e.lineWidth=s,e.setLineDash([l*n,l*(1-n)]),r!==null&&e.clip(r),e.stroke(o),e.restore()},Y=(e,t)=>{let{strokes:n,transform:r,viewBox:o}=e,{strokeColor:s,pauseRatio:l,totalStrokeDuration:d}=t,h=L(o),w=r===null?null:E(r),S=n.map(a=>{let{clipPath:i,strokePath:p,strokeWidth:f}=a,A=B(p);return{clipPath:i===null?null:new Path2D(i),strokePath:new Path2D(p),strokeWidth:f,strokePathLength:A,parsedViewBox:h,strokeColor:s,contextTransform:w}}),m=document.createElement("canvas");m.width=h.width,m.height=h.height;let g=m.getContext("2d");if(g===null)throw new Error("Cannot get 2d context from canvas.");let b=!1,u=null,c=0,v=!1,C=d*1e3,T=n.length,z=C*T,y=a=>{if(b)return;(u===null||v)&&(u=a),c+=a-u,c>z&&(c=0),N(g,t);let i=Math.trunc(c/C);t.includePreview&&S.forEach(f=>{P(g,{...f,strokeColor:t.previewColor},1)}),S.slice(0,i).forEach(f=>{P(g,f,1)});let p=Math.min(1,c%C/C/(1-l));P(g,S[i],p),u=a,window.requestAnimationFrame(y)};window.requestAnimationFrame(y);let M=()=>{v||(u=null,c=0)};document.addEventListener("visibilitychange",M);let x=new ResizeObserver(a=>{for(let i of a)i.contentBoxSize[0].inlineSize>0&&i.contentBoxSize[0].blockSize>0&&i.target instanceof HTMLCanvasElement&&(i.target.width=i.contentBoxSize[0].inlineSize,i.target.height=i.contentBoxSize[0].blockSize)});return x.observe(m),Object.freeze({element:m,dispose:()=>{b=!0,document.removeEventListener("visibilitychange",M),x.disconnect()},isPaused:()=>v,pause:()=>{v=!0},resume:()=>{v=!1}})};export{Y as animator,X as format};
