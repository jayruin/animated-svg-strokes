var f=0,d=()=>(f+=1,`timestamp${Math.floor(performance.timeOrigin+performance.now())}counter${f}`);var u="http://www.w3.org/2000/svg";var k=t=>{let[s,o,r,i]=t.split(" ").map(e=>parseInt(e,10));return{minX:s,minY:o,width:r,height:i}};var w=(t,s)=>{let{includeBackground:o,backgroundColor:r}=t;if(!o)return null;let i=document.createElementNS(u,"g"),e=document.createElementNS(u,"rect");return e.setAttributeNS(null,"width",s.width.toString()),e.setAttributeNS(null,"height",s.height.toString()),e.setAttributeNS(null,"fill",r),i.append(e),i},v=(t,s)=>{let o=document.createElementNS(u,"line");return o.setAttributeNS(null,"x1",t.startPoint.x.toString()),o.setAttributeNS(null,"y1",t.startPoint.y.toString()),o.setAttributeNS(null,"x2",t.endPoint.x.toString()),o.setAttributeNS(null,"y2",t.endPoint.y.toString()),o.setAttributeNS(null,"stroke",s),o.setAttributeNS(null,"stroke-width","1%"),o},x=(t,s)=>{if(!t.includeGrid)return null;let o=document.createElementNS(u,"g"),{width:r,height:i}=s;for(let e=1;e<t.gridColumns;e+=1){let n=r*(e/t.gridColumns),a={startPoint:{x:n,y:0},endPoint:{x:n,y:i}};o.append(v(a,t.gridColor))}for(let e=1;e<t.gridRows;e+=1){let n=i*(e/t.gridRows),a={startPoint:{x:0,y:n},endPoint:{x:r,y:n}};o.append(v(a,t.gridColor))}return o},A=t=>{let{character:s,strokeColor:o,uniqueId:r,isStatic:i}=t,e=[];for(let n=0;n<s.strokes.length;n+=1){let a=s.strokes[n],l=document.createElementNS(u,"path");l.setAttributeNS(null,"d",a.strokePath);let m=null,c=null;if(a.clipPath!==null){let p=["clipPath",...i?["static"]:[],n.toString(),r].join("-");m=document.createElementNS(u,"clipPath"),m.setAttributeNS(null,"id",p),l.setAttributeNS(null,"clip-path",`url(#${p})`),c=document.createElementNS(u,"path"),c.setAttributeNS(null,"d",a.clipPath),m.append(c)}l.setAttributeNS(null,"fill","none"),l.setAttributeNS(null,"stroke",o),l.setAttributeNS(null,"stroke-linecap","round"),l.setAttributeNS(null,"stroke-linejoin","round"),i&&l.setAttributeNS(null,"stroke-width",a.strokeWidth.toString()),e.push({clipPath:m,clipPathPath:c,strokePath:l})}return e},P=(t,s,o)=>{if(!s.includePreview)return null;let r=document.createElementNS(u,"g");return A({character:t,strokeColor:s.previewColor,uniqueId:o,isStatic:!0}).forEach(({clipPath:e,strokePath:n})=>{e!==null&&r.append(e),r.append(n)}),r},y=(t,s,o)=>{let r=document.createElementNS(u,"svg");r.setAttribute("xmlns",u),r.setAttributeNS(null,"viewBox",t.viewBox);let i=k(t.viewBox),e=w(s,i);e!==null&&r.append(e);let n=x(s,i);n!==null&&r.append(n);let a=document.createElementNS(u,"g");t.transform!==null&&a.setAttributeNS(null,"transform",t.transform),r.append(a);let l=P(t,s,o);l!==null&&a.append(l);let m=A({character:t,strokeColor:s.strokeColor,uniqueId:o,isStatic:!1});return m.forEach(({clipPath:c,strokePath:p})=>{c!==null&&a.append(c),a.append(p)}),{svg:r,group:a,strokesComponents:m}},C=t=>{for(;t.lastChild!==null;)t.removeChild(t.lastChild);for(;t.attributes.length>0;)t.removeAttribute(t.attributes[0].name)};var N=t=>{let s=document.createElementNS(u,"path");return s.setAttributeNS(null,"d",t),Math.ceil(s.getTotalLength())};var q="svg-wa",E=(t,s,o)=>{let r=[],i=[],{strokes:e}=t,{pauseRatio:n,totalStrokeDuration:a}=s,l=e.length,m=a*l,{strokePath:c,strokeWidth:p}=e[o],g=N(c),S=o/l,h=(o+(1-n))/l;o*a>0&&(r.push({offset:0,strokeDasharray:`0 ${g}`}),i.push({offset:0,strokeWidth:"0",easing:"steps(1, end)"})),r.push({offset:S,strokeDasharray:`0 ${g}`,easing:"linear"}),i.push({offset:S,strokeWidth:`${p}`}),h<1&&(r.push({offset:h,strokeDasharray:`${g} 0`}),i.push({offset:h,strokeWidth:`${p}`})),r.push({offset:1,strokeDasharray:`${g} 0`}),i.push({offset:1,strokeWidth:`${p}`});let b={duration:m*1e3,iterations:1/0};return{dashKeyframes:r,widthKeyframes:i,keyframeOptions:b}},M=(t,s)=>{let o=d(),{svg:r,strokesComponents:i}=y(t,s,o),e=[];for(let n=0;n<t.strokes.length;n+=1){let a=i[n],{dashKeyframes:l,widthKeyframes:m,keyframeOptions:c}=E(t,s,n),p=a.strokePath.animate(l,c);e.push(p);let g=a.strokePath.animate(m,c);e.push(g)}return Object.freeze({element:r,dispose:()=>{e.forEach(n=>{n.cancel()}),C(r)},isPaused:()=>e.every(n=>n.playState==="paused"),pause:()=>{e.forEach(n=>{n.pause()})},resume:()=>{e.forEach(n=>{n.play()})}})};export{M as animator,q as format};
